[32mINFO    [0m pytest_operator.plugin:plugin.py:734 Connecting to existing model localhost-localhost:test on unspecified cloud
[32mINFO    [0m juju.model:model.py:2097 Deploying ch:arm64/jammy/s3-integrator-32
[32mINFO    [0m juju.model:model.py:2097 Deploying ch:arm64/jammy/self-signed-certificates-178
[32mINFO    [0m juju.model:model.py:2097 Deploying local:jammy/postgresql-0
[33mWARNING [0m juju.model:model.py:1563 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: waiting for machine
  postgresql-aws/1 [allocating] waiting: waiting for machine
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [allocating] waiting: agent initialising
  postgresql-aws/1 [allocating] waiting: agent initialising
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] maintenance: installing PostgreSQL
  postgresql-aws/1 [executing] maintenance: installing PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] maintenance: installing PostgreSQL
  postgresql-aws/1 [executing] maintenance: installing PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] maintenance: installing PostgreSQL
  postgresql-aws/1 [executing] maintenance: installing PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: waiting to start PostgreSQL
  postgresql-aws/1 [executing] waiting: waiting to start PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] waiting: waiting to start PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] waiting: waiting to start PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] waiting: waiting to start PostgreSQL
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] waiting: awaiting for member to start
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] active: Primary
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [executing] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] active: Primary
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [idle] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] maintenance: Executing restart operation
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [idle] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] active: Primary
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  postgresql-aws/0 [idle] waiting: awaiting for cluster to start
  postgresql-aws/1 [executing] maintenance: reconfiguring cluster
[33mWARNING [0m juju.client.connection:connection.py:578 Receiver: Connection closed, reconnecting
[33mWARNING [0m juju.client.connection:connection.py:578 Receiver: Connection closed, reconnecting
[32mINFO    [0m integration.test_backups_pitr:test_backups_pitr.py:78 deleting the previously created backups
[1m[31mERROR   [0m asyncio:base_events.py:1758 Task exception was never retrieved
future: <Task finished name='Task-3563' coro=<Connection.reconnect() done, defined at /home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py:779> exception=TimeoutError()>
Traceback (most recent call last):
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/client.py", line 647, in __await_impl_timeout__
    return await self.__await_impl__()
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/client.py", line 651, in __await_impl__
    _transport, _protocol = await self._create_connection()
  File "/usr/lib/python3.10/asyncio/base_events.py", line 1103, in create_connection
    transport, protocol = await self._create_connection_transport(
  File "/usr/lib/python3.10/asyncio/base_events.py", line 1133, in _create_connection_transport
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 788, in reconnect
    res = await connector(
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 868, in _connect_with_login
    await self._connect(endpoints)
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 817, in _connect
    result = await task
  File "/usr/lib/python3.10/asyncio/tasks.py", line 571, in _wait_for_one
    return f.result()  # May raise f.exception().
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 806, in _try_endpoint
    return await self._open(endpoint, cacert)
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 427, in _open
    return (await websockets.connect(
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/client.py", line 646, in __await_impl_timeout__
    async with asyncio_timeout(self.open_timeout):
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/async_timeout.py", line 169, in __aexit__
    self._do_exit(exc_type)
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/async_timeout.py", line 252, in _do_exit
    raise asyncio.TimeoutError
asyncio.exceptions.TimeoutError
[1m[31mERROR   [0m asyncio:base_events.py:1758 Task exception was never retrieved
future: <Task finished name='Task-3565' coro=<Connection.reconnect() done, defined at /home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py:779> exception=InvalidStatusCode(503, Headers([('Content-Type', 'text/plain; charset=utf-8'), ('X-Content-Type-Options', 'nosniff'), ('Date', 'Sun, 18 Aug 2024 02:32:26 GMT'), ('Content-Length', '31')]))>
Traceback (most recent call last):
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 788, in reconnect
    res = await connector(
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 868, in _connect_with_login
    await self._connect(endpoints)
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 817, in _connect
    result = await task
  File "/usr/lib/python3.10/asyncio/tasks.py", line 571, in _wait_for_one
    return f.result()  # May raise f.exception().
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 806, in _try_endpoint
    return await self._open(endpoint, cacert)
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py", line 427, in _open
    return (await websockets.connect(
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/client.py", line 647, in __await_impl_timeout__
    return await self.__await_impl__()
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/client.py", line 654, in __await_impl__
    await protocol.handshake(
  File "/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/client.py", line 325, in handshake
    raise InvalidStatusCode(status_code, response_headers)
websockets.exceptions.InvalidStatusCode: server rejected WebSocket connection: HTTP 503
[32mINFO    [0m pytest_operator.plugin:plugin.py:862 Model status:

Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.4.4    unsupported  02:32:35Z

App                       Version  Status   Scale  Charm                     Channel        Rev  Exposed  Message
postgresql-aws            14.12    active     0/2  postgresql                                 0  no       
s3-integrator                      blocked    0/1  s3-integrator             latest/stable   32  no       Missing parameters: ['access-key', 'secret-key']
self-signed-certificates           active     0/1  self-signed-certificates  latest/edge    178  no       

Unit                         Workload  Agent  Machine  Public address  Ports     Message
postgresql-aws/0             unknown   lost   2        10.15.208.164   5432/tcp  agent lost, see 'juju show-status-log postgresql-aws/0'
postgresql-aws/1*            unknown   lost   3        10.15.208.233   5432/tcp  agent lost, see 'juju show-status-log postgresql-aws/1'
s3-integrator/0*             unknown   lost   0        10.15.208.31              agent lost, see 'juju show-status-log s3-integrator/0'
self-signed-certificates/0*  unknown   lost   1        10.15.208.238             agent lost, see 'juju show-status-log self-signed-certificates/0'

Machine  State  Address        Inst id        Base          AZ  Message
0        down   10.15.208.31   juju-68d256-0  ubuntu@22.04      Running
1        down   10.15.208.238  juju-68d256-1  ubuntu@22.04      Running
2        down   10.15.208.164  juju-68d256-2  ubuntu@22.04      Running
3        down   10.15.208.233  juju-68d256-3  ubuntu@22.04      Running

[32mINFO    [0m pytest_operator.plugin:plugin.py:868 Juju error logs:

machine-1: 02:24:00 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-1: 02:24:00 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-self-signed-certificates-0: 02:24:01 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-s3-integrator-0: 02:24:16 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-0: 02:24:16 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-0: 02:24:16 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-postgresql-aws-1: 02:24:19 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-3: 02:24:21 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-3: 02:24:21 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-2: 02:24:27 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-2: 02:24:27 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-postgresql-aws-0: 02:24:27 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk

[32mINFO    [0m pytest_operator.plugin:plugin.py:947 Forgetting model main...
{"uid":"577e90ae69f6639d","name":"test_async_replication","fullName":"tests.integration.ha_tests.test_async_replication#test_async_replication","historyId":"13fea4a7f868df221602972263ad2fd0","time":{"start":1722827557129,"stop":1722829266018,"duration":1708889},"description":"Test async replication between two PostgreSQL clusters.","descriptionHtml":"<p>Test async replication between two PostgreSQL clusters.</p>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"event_loop","time":{"start":1722826246667,"stop":1722826246667,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1722826246668,"stop":1722826248182,"duration":1514},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1722826246668,"stop":1722826246668,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model","time":{"start":1722826248182,"stop":1722826248183,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model","time":{"start":1722826248183,"stop":1722826252920,"duration":4737},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"continuous_writes","time":{"start":1722827557128,"stop":1722827557129,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1722827557128,"stop":1722827557128,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test async replication between two PostgreSQL clusters.","status":"passed","steps":[],"attachments":[{"uid":"3fec8af15f27750","name":"log","source":"3fec8af15f27750.txt","type":"text/plain","size":10333}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"continuous_writes::finalizer","time":{"start":1722829266019,"stop":1722829267142,"duration":1123},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1722829267142,"stop":1722829267142,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model::finalizer","time":{"start":1722829480544,"stop":1722829480545,"duration":1},"status":"broken","statusMessage":"websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])\n","statusTrace":"  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 300, in finalizer\n    event_loop.run_until_complete(async_finalizer())\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 292, in async_finalizer\n    await gen_obj.__anext__()\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/tests/integration/ha_tests/test_async_replication.py\", line 87, in second_model\n    await ops_test._controller.destroy_model(second_model_name, destroy_storage=True)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/controller.py\", line 386, in destroy_models\n    uuids = await self.model_uuids()\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/controller.py\", line 586, in model_uuids\n    user_model_list = await model_manager_facade.ListModelSummaries(user_tag=user, all_=all)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/facade.py\", line 486, in wrapper\n    reply = await f(*args, **kwargs)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/_client9.py\", line 735, in ListModelSummaries\n    reply = await self.rpc(msg)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/facade.py\", line 659, in rpc\n    result = await self.connection.rpc(msg, encoder=TypeEncoder)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/juju/client/connection.py\", line 649, in rpc\n    await self._ws.send(outgoing)\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/protocol.py\", line 635, in send\n    await self.ensure_open()\n  File \"/home/ubuntu/actions-runner/_work/test-runners-2-is-arm64-postgresql-operator/test-runners-2-is-arm64-postgresql-operator/.tox/integration/lib/python3.10/site-packages/websockets/legacy/protocol.py\", line 939, in ensure_open\n    raise self.connection_closed_exc()\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1722829480546,"stop":1722829483137,"duration":2591},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1722829483138,"stop":1722829483138,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1722829483138,"stop":1722829483138,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1722829483138,"stop":1722829483138,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"@pytest.mark.skipif(False, reason='Requires juju 3')"},{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration.ha_tests"},{"name":"suite","value":"test_async_replication"},{"name":"host","value":"openstack-arm-large-20-266767701e068de7590e58e8"},{"name":"thread","value":"10571-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.ha_tests.test_async_replication"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"45810bf53a99053a","status":"unknown","time":{}}],"categories":[],"history":{"statistic":{"failed":0,"broken":5,"skipped":17,"passed":14,"unknown":18,"total":54},"items":[{"uid":"ab02ce0f2c69936e","reportUrl":"../133//#testresult/ab02ce0f2c69936e","status":"passed","time":{"start":1722739919130,"stop":1722740460051,"duration":540921}},{"uid":"b01ab66f67c6ee8d","reportUrl":"../132//#testresult/b01ab66f67c6ee8d","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1722663322973,"stop":1722663322973,"duration":0}},{"uid":"82b28218403722d0","reportUrl":"../131//#testresult/82b28218403722d0","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1722567549798,"stop":1722567549798,"duration":0}},{"uid":"311400422eca5bb4","reportUrl":"../130//#testresult/311400422eca5bb4","status":"unknown","time":{}},{"uid":"32cbe04d1ed4dcaf","reportUrl":"../129//#testresult/32cbe04d1ed4dcaf","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql/0 [executing] waiting: Waiting for the database to be started in all units\n  postgresql/1 [idle] waiting: Waiting for the standby leader start the database\n  postgresql/2 [idle] waiting: Waiting for the standby leader start the database","time":{"start":1722395025405,"stop":1722397867011,"duration":2841606}},{"uid":"ddef003ec5305986","reportUrl":"../128//#testresult/ddef003ec5305986","status":"unknown","time":{}},{"uid":"b41629a25ea7c09c","reportUrl":"../127//#testresult/b41629a25ea7c09c","status":"passed","time":{"start":1722220069069,"stop":1722220727698,"duration":658629}},{"uid":"9f63b55ac91a5e8f","reportUrl":"../125//#testresult/9f63b55ac91a5e8f","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1722046272865,"stop":1722046272865,"duration":0}},{"uid":"cc4823efb3f90eec","reportUrl":"../124//#testresult/cc4823efb3f90eec","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql/1 [idle] waiting: awaiting for member to start","time":{"start":1721959589569,"stop":1721961806492,"duration":2216923}},{"uid":"4e46e0f6264783ae","reportUrl":"../123//#testresult/4e46e0f6264783ae","status":"passed","time":{"start":1721878001454,"stop":1721878509057,"duration":507603}},{"uid":"74fbe7846339ddf1","reportUrl":"../122//#testresult/74fbe7846339ddf1","status":"unknown","time":{}},{"uid":"fc59593ec7d11441","reportUrl":"../121//#testresult/fc59593ec7d11441","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1721704450148,"stop":1721704450148,"duration":0}},{"uid":"c0db5a15249ab869","reportUrl":"../120//#testresult/c0db5a15249ab869","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1721621878823,"stop":1721621878823,"duration":0}},{"uid":"b530b7527f8a3972","reportUrl":"../119//#testresult/b530b7527f8a3972","status":"unknown","time":{}},{"uid":"7b9396bc512a1666","reportUrl":"../118//#testresult/7b9396bc512a1666","status":"unknown","time":{}},{"uid":"81386566569689f1","reportUrl":"../115//#testresult/81386566569689f1","status":"unknown","time":{}},{"uid":"b7643e7bdcced45c","reportUrl":"../114//#testresult/b7643e7bdcced45c","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1721271515523,"stop":1721271515523,"duration":0}},{"uid":"9199419dc0284fdf","reportUrl":"../112//#testresult/9199419dc0284fdf","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql/1","time":{"start":1721182064471,"stop":1721182986245,"duration":921774}},{"uid":"1df961208e82fa84","reportUrl":"../111//#testresult/1df961208e82fa84","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1721095129512,"stop":1721095129512,"duration":0}},{"uid":"589d84f1448b213b","reportUrl":"../110//#testresult/589d84f1448b213b","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1721008866271,"stop":1721008866271,"duration":0}}]},"tags":["asyncio","abort_on_fail","@pytest.mark.skipif(False, reason='Requires juju 3')","group(1)"]},"source":"577e90ae69f6639d.json","parameterValues":[]}